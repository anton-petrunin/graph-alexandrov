\documentclass{article}
\usepackage{amssymb, amsfonts, amsmath, amsthm}
\usepackage{enumerate}
\usepackage{caption}
\usepackage[colorlinks=true,
citecolor=black,
linkcolor=black,
anchorcolor=black,
filecolor=black,
menucolor=black,
urlcolor=black%,
]{hyperref}
\usepackage[normalem]{ulem}%дабы зачёркивать
\usepackage{cancel}%дабы зачёркивать
\usepackage{array}%для таблиц
\usepackage{longtable}%для таблиц

\usepackage{epsfig,lpic,wrapfig}
\usepackage{bm}%makes better bold fornt in math
\usepackage{multicol}

\usepackage[utf8]{inputenc}
\usepackage[T1,T2A]{fontenc}
\usepackage[russian,
%slovak,
german,
%french,
english]{babel}

\usepackage[
sorting=debug,
bibencoding=auto,
backend=biber,
maxnames=10,
%babel=other,
autolang=other,
doi=false,
url=false,
style=numeric-comp,
isbn=false]{biblatex}
\usepackage{csquotes}
\AtEveryBibitem{\clearlist{language}}
\AtEveryBibitem{\clearlist{note}}
\renewbibmacro{in:}{}
\renewcommand*{\bibfont}{\scriptsize}
\addbibresource{library.bib}

\DeclareFieldFormat{postnote}{#1}
\DeclareFieldFormat{multipostnote}{#1}
\DeclareFieldFormat{pages}{#1}

\newcommand{\nofootnote}[1]{%
\begingroup\def\thefootnote{}\footnotetext{#1}\endgroup}

\hyphenation{Alex-an-drov}

\def\thetitle{Graph comparison meets Alexandrov}
\def\theauthors{Nina Lebedeva and Anton Petrunin}
\hypersetup{pdftitle={\thetitle},
pdfauthor={\theauthors}}

\newcommand{\Addresses}{{\bigskip\footnotesize

\noindent Nina Lebedeva,
\par\nopagebreak
 \textsc{St. Petersburg State University, 7/9 Universitetskaya nab., St. Petersburg, 199034, Russia}
\par
\nopagebreak
 \textsc{St. Petersburg Department of V. A. Steklov Institute of Mathematics of the Russian Academy of Sciences, 27 Fontanka nab., St. Petersburg, 191023, Russia}
  \par\nopagebreak
  \textit{Email}: \texttt{lebed@pdmi.ras.ru}

\medskip

\noindent   Anton Petrunin, 
\par\nopagebreak
 \textsc{Math. Dept. PSU, University Park, PA 16802, USA.}
  \par\nopagebreak
  \textit{Email}: \texttt{petrunin@math.psu.edu}
  
}}

\def\parit#1{\medskip\noindent{\it #1}}
\def\parbf#1{\medskip\noindent{\bf #1}}
\def\qeds{\qed\par\medskip}
\def\qedsf{\vskip-6mm\qeds}

\renewcommand{\labelitemi}{$\mathsurround=0pt \diamond$}
\renewcommand{\labelitemii}{$\mathsurround=0pt \circ$}

%THEOREM
\newcounter{thm}[section]
\renewcommand{\thethm}{\arabic{thm}}
\def\claim#1{\par\medskip\noindent\refstepcounter{thm}\hbox{\bf\boldmath #1.}
\it\ %\ignorespaces
}
\def\endclaim{
\par\medskip}
\newenvironment{thm}{\claim}{\endclaim}

\newcommand*{\z}[1]{#1\nobreak\discretionary{}%
            {\hbox{$\mathsurround=0pt #1$}}{}}


\begin{document}
%\pagestyle{empty}\renewcommand\includegraphics[2][{}]{}


\title{\thetitle}
\author{\theauthors}

\date{}
\maketitle
\begin{abstract}
Graph comparison is a certain type of condition on metric space encoded by a finite graph.
We show that any nontrivial graph comparison implies one of two Alexandrov's comparisons.
The proof gives a complete description of graphs with trivial graph comparisons.
\end{abstract}

\parbf{Preface.}
The notion of graph comparison was introduced in \cite{lebedeva-petrunin-zolotov}.
It was studied further in \cite{toyoda,toyoda2019,lebedeva-petrunin-CBB,lebedeva,lebedeva-petrunin,lebedeva-petrunin-octahedron}.
Let us mention some of the results.
\begin{itemize}
\item Graph comparisons for the tripod and four-cycle capture nonnegative and nonpositive curvature in the sense of Alexandrov; see below.
\end{itemize}
\begin{itemize}
\item Graph comparison for star graphs provides a stronger version of the so-called \emph{Lang--Schroeder--Sturm inequality} \cite{lang-schroeder, sturm, lebedeva-petrunin-CBB}.
\end{itemize}
\begin{itemize}
\item The all-tree comparison gives a metric description of target spaces of submetries from subsets of Hilbert space \cite{lebedeva-petrunin-zolotov}.
\end{itemize}

\noindent
\begin{minipage}
{.80\textwidth}
\begin{itemize}
\item The comparison for the tree on the diagram has tight relation with the \emph{transport continuity property} and the so-called \emph{Ma--Trudinger--Wang condition}~\cite{lebedeva-petrunin-zolotov,ma-trudinger-wang}.
\end{itemize}
\end{minipage}
\hfill
\begin{minipage}{.17\textwidth}
\centering
\vskip-1mm
\includegraphics{mppics/pic-5}
\end{minipage}
\begin{itemize}
\item Octahedron comparison holds in products of trees~\cite{lebedeva-petrunin-octahedron}.
\end{itemize}

We will show that any nontrivial graph comparison implies one of two Alexandrov's comparisons.

\parbf{Introduction.}
Let us start with the definition.
Suppose $\Gamma$ is a graph with vertices $v_1,\dots,v_n$.
We write $v_i\sim v_j$ (or $v_i\nsim v_j$) if $v_i$ is adjacent (respectively nonadjacent) to $v_j$.

A metric space $X$ meets the \emph{$\Gamma$-comparison} if for any $n$ points in $X$ labeled by vertices of $\Gamma$ there is a model configuration $\tilde v_1,\dots,\tilde v_n$ in the Hilbert space $\mathbb{H}$ such that 
\begin{align*}
v_i\sim v_j\quad&\Longrightarrow\quad|\tilde v_i-\tilde v_j|_{\mathbb{H}}\leqslant | v_i-v_j|_{X},
\\
v_i\nsim v_j\quad&\Longrightarrow\quad|\tilde v_i-\tilde v_j|_{\mathbb{H}}\geqslant | v_i-v_j|_{X};
\end{align*}
here $|\ -\ |_X$ denotes the metric in~$X$.
(Note that $v_i$ refers to a vertex in $\Gamma$ and to the corresponding point in $X$.)

\begin{wrapfigure}{r}{35 mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-10}
\end{wrapfigure}

Denote by $T_3$ and $C_4$ the tripod and four-cycle shown on the diagram.
The $C_4$-comparison is equivalent to nonnegative curvature,
and $T_3$-comparison is equivalent to the nonpositive curvature in the sense of Alexandrov \cite{lebedeva-petrunin-zolotov}.
These definitions are usually applied to length spaces, but they can be applied to general metric spaces;
the latter convention is used in \cite{alexander2019alexandrov}.

\begin{thm}{Theorem}
Let $\Gamma$ be an arbitrary finite graph.
Then either $\Gamma$-comparison holds in any metric space,
or it implies $C_4$- or $T_3$-comparison.
\end{thm}

The next statement is a corollary from the proof of the theorem;
it describes all graphs with trivial comparison.

\begin{thm}{Corollary} Let $\Gamma$ be a finite connected graph.
Suppose that $\Gamma$-comparison is trivial;
that is, it holds in any metric space.
Then $\Gamma$ can be constructed from a path $P_{\ell}$ of length $\ell\geqslant 0$ and two complete graphs $K_{m_1}$, $K_{m_2}$ by attaching $k_1$ vertices of $K_{m_1}$ to the left end of $P_{\ell}$ and $k_2$ vertices of $K_{m_2}$ to the right end of~$P_{\ell}$.
\end{thm}

The graph $\Gamma$ in the corollary is described by five integers $(m_1$, $k_1$, $\ell$, $k_2$, $m_2)$ such that $\ell \geqslant 0$, $m_i\geqslant k_i\geqslant 0$, and $k_i>0$ if $m_i>0$ for each $i$.
Examples of such graphs and their 5-arrays are shown below.
\begin{figure}[ht!]
\centering
\includegraphics{mppics/pic-15}
\end{figure}

\bigskip

\parbf{Proof of the theorem.}
Suppose $\Gamma$ has connected components $\Gamma_1,\dots,\Gamma_k$.
Observe that $\Gamma$-comparison holds in a metric space $X$ if and only if so does every $\Gamma_i$-comparison.
Therefore we can assume that $\Gamma$ is connected.

Suppose $\Gamma$ is a graph with vertices $v_1,\dots,v_n$ as before.
Remove two vertices, say $v_1$ and $v_2$, from $\Gamma$, and add a new vertex $w$ such that for any other vertex $u$ we have
\begin{itemize}
 \item if $u\sim v_1$ and $u\sim v_2$, then $u\sim w$;
 \item if $u\nsim v_1$ and $u\nsim v_2$, then $u\nsim w$;
 \item in the remaining cases, we may choose $u\sim w$ or $u\nsim w$.
\end{itemize}
Denote the obtained graph by $\Gamma'$.

Applying the definition of $\Gamma$-comparison assuming that $v_1=v_2$ in $X$, we get the following.

\begin{thm}{Claim}
If $\Gamma$-comparison holds in a metric space $X$, then so does $\Gamma'$-comparison.

\end{thm}

The described construction of $\Gamma'$ from $\Gamma$ will be called \emph{vertex fusion}.
If a graph $\Delta$ can be obtained from $\Gamma$ applying vertex fusion several times, then we will write $\Delta\prec \Gamma$.

From above we get the following two observations:
\begin{itemize}
 \item If $\Delta$ is an induced subgraph of a connected finite graph $\Gamma$, then $\Delta\prec \Gamma$.
 \item If $\Delta\prec \Gamma$, then $\Gamma$-comparison implies $\Delta$-comparison.
\end{itemize}
Hence we get the following reformulation of the theorem.

\begin{thm}{Reformulation}
For any finite connected graph $\Gamma$,
\begin{enumerate}[(a)]
\item $\Gamma$-comparison is trivial,  or
\item $C_4\prec \Gamma$, or
\item $T_3\prec \Gamma$.
\end{enumerate}
\end{thm}

A connected graph will be called \emph{multipath} if it has an integer function $\ell$ on its vertex set such that 
$$v\sim w
\quad\Longleftrightarrow\quad
|\ell(v)-\ell(w)|\leqslant 1.$$
The value $\ell(w)$ will be called the \emph{level} of the vertex $w$.
Multipath is completely described by a sequence of integers that give the number of vertexes on each level.
\begin{figure}[ht!]
\centering
\medskip
\includegraphics{mppics/pic-20}
\medskip
\end{figure}
An example of a multipath with its sequence is shown on the diagram. 

\begin{thm}{Lemma}
Let $\Gamma$ be a connected finite graph such that $C_4\nprec\Gamma$ and  $T_3\nprec\Gamma$.
Then $\Gamma$ is a multipath.
\end{thm}

\parit{Proof.}
We will denote by $|\ -\ |_\Gamma$ the path metric on the vertex set of $\Gamma$;
it is the number of edges in a shortest path connecting two vertices.
Let us show that 
\[|u-w|_\Gamma\geqslant |u-v|_\Gamma\geqslant|v-w|_\Gamma\geqslant 2
\quad\Longrightarrow\quad |u-w|_\Gamma=|u-v|_\Gamma+|v-w|_\Gamma
\leqno({*})\]
for any three vertices $u$, $v$, and $w$ in $\Gamma$.

Suppose $({*})$ does not hold.
Let $\Delta$ be the subgraph of $\Gamma$ induced by three shortest paths between each pair in the triple $u$, $v$, $w$.
\begin{figure}[ht!]
\centering
\includegraphics{mppics/pic-25}
\end{figure}
Note that $\Delta$ is either a cycle
or it has three paths from a vertex, say $o$, to each of $u$, $v$, and $w$ such that each of these paths does not visit the remaining vertices in the triple.
In these cases, we have $C_4\prec\Delta$ or $T_3\prec\Delta$ respectively.
By the observation above $\Delta\prec\Gamma$; $({*})$ is proved.

Denote by $d$ the diameter of $\Gamma$.
We can assume that $d\geqslant 2$;
if $d=1$, then $\Gamma$ is a complete graph; in particular, it is a multipath.

Choose vertices $p$ and $q$ such that $|p-q|_\Gamma=d$.
Let us show that $\Gamma$ is a multipath with the following level function
\[\ell(w)=
\begin{cases}
\hfil |p-w|_\Gamma&\text{if}\quad |p-w|_\Gamma\geqslant 2,
\\
d-|q-w|_\Gamma&\text{if}\quad |q-w|_\Gamma\geqslant 2,
\\
\hfil 1&\hfil\text{otherwise.}
\end{cases}
\]
By $({*})$, $|p-w|_\Gamma+|q-w|_\Gamma=d$ if $|p-w|_\Gamma\geqslant 2$ and $|q-w|_\Gamma\geqslant 2$;
therefore $\ell$ is well defined.

If $d\geqslant 4$, then the statement follows from $({*})$.
Two cases remain $d=2$ and $d=3$.

\begin{wrapfigure}{r}{17 mm}
\vskip-6mm
\centering
\includegraphics{mppics/pic-26}
\vskip-2mm
\end{wrapfigure}

Observe that the fan graph on the diagram cannot appear as an induced subgraph of $\Gamma$.
If this is the case, then applying the vertex fusion to the ends of the marked edge, we could get a tripod --- a contradiction.

\parit{Case $d=2$.}
By $({*})$, $\ell^{-1}(0)$ and $\ell^{-1}(2)$ are cliques.
Observe that $\ell(v)=1$ if and only if $p\sim v$ and $q\sim v$.
Note that $\ell^{-1}(1)$ is a clique;
indeed, if $u\nsim v$ for some $u,v\in\ell^{-1}(1)$,
then the subgraph induced by $\{p,q,u,v\}$ is a four-cycle --- a contradiction.

It remains to show that $u\sim v$, $v\sim w$, and $u\nsim w$ if $\ell(u)=0$, $\ell(v)=1$, and $\ell(w)=2$.

\begin{wrapfigure}{r}{17 mm}
\vskip-2mm
\centering
\includegraphics{mppics/pic-27}
\vskip4mm
\includegraphics{mppics/pic-28}
\end{wrapfigure}

Suppose $u\sim w$. 
Note that $v\sim u$ and $v\sim w$; otherwise, $\Gamma$ contains an induced 4- or 5-cycle with vertices $p, u, v, w, q$.
Therefore the induced subgraph for $\{p,u,v,w,q\}$ is isomorphic to the fan --- a contradiction.

Now, suppose $v\nsim w$; note that $w\ne q$.
Denote by $m$ a midvertex of $w$ and $p$.
From above, $\ell(m)=1$; in particular, $v\sim m\sim q$.
And again, the induced subgraph for $\{p,v,m,w,q\}$ is isomorphic to the fan --- a contradiction.
The same way one shows that $u\sim v$.

\parit{Case $d=3$.}
We need to show that $u\sim v$ if $\ell(u)=2$ and $\ell(v)=3$;
the rest follows from $({*})$.

\begin{wrapfigure}{r}{20 mm}
\vskip-8mm
\centering
\includegraphics{mppics/pic-29}
\vskip-2mm
\end{wrapfigure}

Suppose the contrary;
let $u'$ ($v'$) be a midvertex of $u$ and $q$ (respectively, $v$ and $p$).
Observe that $\ell(u')=3$, $\ell(v')=2$, and $u'\sim v'$ (otherwise the subgraph induced by $\{u,v,u',v'\}$ is a four-cycle).
It follows that the subgraph induced by $\{p,q,u,v,u',v'\}$ is shown on the diagram.
Note that it contains the fan --- a contradiction. 
\qeds




\begin{thm}{Proposition}
Let $\Gamma$ be a multipath with sequence $(k_0,\dots, k_m)$.
Suppose $C_4\nprec\Gamma$ and  $T_3\nprec\Gamma$.
Then 
\begin{enumerate}[(a)]
 \item\label{lem:multipath:5} If $m\geqslant 4$, then $k_2=\dots=k_{m-2}=1$.
 \item\label{lem:multipath:4} If $m= 3$, then $k_1=1$ or $k_2=1$.
 \item\label{lem:multipath:3} If $m= 2$, then $k_0=1$, $k_1=1$, or $k_2=1$.
\end{enumerate}

\end{thm}

\parit{Proof.} Assuming the contrary in each case we get

\parit{(\ref{lem:multipath:5})}
if $m\geqslant 4$, then multipath $(1,1,2,1,1)$ is an induced subgraph of~$\Gamma$,

\parit{(\ref{lem:multipath:4})}
if $m=3$, then multipath $(1,2,2,1)$ is an induced subgraph of~$\Gamma$,

\parit{(\ref{lem:multipath:3})}
if $m=2$, then multipath $(2,2,2)$ is an induced subgraph of~$\Gamma$.

In each case, we arrive at a contradiction by applying vertex fusion to the ends of the marked edges as shown on the diagram.

\begin{figure}[h!]
\centering
\includegraphics{mppics/pic-30}
\end{figure}
\qedsf


It remains to show that $\Gamma$-comparison is trivial for every multipath $\Gamma$ described in the proposition.
This is done by prescribing the coordinates for the needed model configuration on the real line.

Each edge of $\Gamma$ comes with weight --- the distance between the endpoints in~$X$.
Define the distance $\|v-w\|_\Gamma$ as the minimal total weight of paths connecting $v$ to $w$ in $\Gamma$.
Note that 
\[\|v-w\|_\Gamma\geqslant |v-w|_X\]
for any $v$ and $w$.

If $m\leqslant 1$, then $\Gamma$ is a complete graph.
In this case, $\Gamma$-comparison is trivial.
It remains to consider cases $m\geqslant2$.

Let us choose a special vertex $w$ that is unique on its level and not too far from the middle of $\Gamma$.
Namely, if $m\geqslant 4$, then choose $w$ on the second level;
by the proposition, it is unique on its level.
If $m=3$, then by the proposition we can assume that $k_2=1$; in this case choose $w$ on the second level.
Finally, if $m=2$, let $w$ be any vertex that is unique on its level; it exists by the proposition. 

For every vertex $v_i$, let
\[\tilde v_i=\pm \|w-v_i\|_\Gamma,\]
where the sign is plus if $v_i$ has a higher level than $w$ and minus otherwise.
By the triangle inequality, the obtained configuration $\tilde v_1,\dots,\tilde v_n\in\mathbb{R}$ meets the condition of $\Gamma$-comparison.
\qeds

\parbf{Remarks.}
The statements in the preface indicate that for a carefully chosen graph (or a family of graphs) its graph comparison is responsible for meaningful geometric properties of metric spaces.
Let us state two more observations about graph comparison.

Graph comparisons for all complete bipartite graphs imply the so-called \emph{pure inequalities of negative type} \cite[6.1.1]{deza-laurent}.
By Schoenberg's criterion, these inequalities are sufficient for the existence of isometric embedding into a Hilbert space \cite[6.2.1]{deza-laurent}.
In particular, the comparisons for all graphs imply that the metric space is isometric to a subset of a Hilbert space.
The latter can be also proved the same way as Proposition 1.9 in \cite{toyoda}.

\begin{wrapfigure}{r}{17 mm}
\vskip-6mm
\centering
\includegraphics{mppics/pic-45}
\vskip-2mm
\end{wrapfigure}

The last observation works for arbitrary metrics.
For length metrics, most graph comparisons imply that the space is isometric to a subset of a Hilbert space.
Indeed if $C_4\prec\Gamma$ and $T_3\prec\Gamma$ (as for the graph on the diagram), then any complete length space that meets $\Gamma$-comparison has vanishing curvature in the sense of Alexandrov; in particular, it is isometric to a convex closed set in a Hilbert space.





\parbf{Acknowledgments.}
We want to thank Alexander Lytchak for help. 

The first author was partially supported by the Russian Foundation for Basic Research, grant 20-01-00070; the second author was partially supported by the National Science Foundation, grant DMS-2005279
and the Ministry of Education and Science of the Russian Federation, grant 075-15-2022-289.

{\sloppy
\printbibliography[heading=bibintoc]
\fussy
}

\Addresses
\end{document}
